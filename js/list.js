"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","bootstrapPaginator"],function(t,e,a,i,r,n){function o(){}function l(){if(r.util.menu&&r.util.menu.length>0){var e=r.util.getAdvSource().u;e||(e=r.util.getQueryString("u"));var a="";e&&(a="?u="+e);for(var i=r.util.menu.reverse(),n="<li><a id='breadcrumb_home' href='/'>"+t.i18n.map.Home+"</a></li>",o=0;o<i.length;o++){var l=i[o].menu_name+"-l-"+r.util.encodeMenuType(i[o].menu_type)+"-"+r.util.encodeMenuType(r.util.getUvid())+".html"+a;o==i.length-1?(n=n+"<li class='active'><a href='"+l+"'>"+i[o].menu_name+"</a></li>",t("#product_classify_name").html(i[o].menu_name),document.title=i[o].menu_name):n=n+"<li><a href='"+l+"'>"+i[o].menu_name+"</a></li>"}t(".breadcrumb").html(n)}}function s(){t("#list_loading").removeClass("hide"),r.dao.productsbymenuandtag({currencyId:r.util.getLocalCurrency(),productType:v,currentPage:g.curPage,orderby:m,tags:h.join(",")},function(e){if(u(e.tags),e.page){g.amount=e.page.amount,g.pageSize=e.page.pageSize;var a=(g.curPage-1)*g.pageSize+1,i=g.curPage*g.pageSize;i>g.amount&&(i=g.amount),t("#current_product_number").html(a+"-"+i),t("#product_total_number").html(g.amount)}else t("#current_product_number").html("0-0"),t("#product_total_number").html(0);var n=e.products;if(n&&n.length>0?(c(n),p(n),1==g.curPage&&d(),t("#item_list").show(),t(".empty-data").hide()):(t("#item_list").hide(),t(".empty-data").show()),t(".sort-wrap").removeClass("invisibility"),sessionStorage.menus){var o=JSON.parse(sessionStorage.menus);if(o){t("#classify_list_wrap").html(t("#classifyListTempl").tmpl(o)),t("#classify_list_wrap a").each(function(){var e=r.util.getAdvSource().u,a=t(this).attr("href");if(a&&a.indexOf("-l-")>-1){var i=r.util.getListParams(a),n=i[i.length-2];n=r.util.encodeMenuType(n);var o=r.util.encodeMenuType(r.util.getUvid());e||(e=r.util.getQueryString("u"));var l="";e&&(l="?u="+e);var s=a.substring(0,a.indexOf("-l-"));newHref=r.util.formatProductName(s)+"-l-"+n+"-"+o+".html"+l,a=newHref,t(this).attr("href",newHref)}});for(var l=t("#classify_list_wrap span"),s=0;s<l.length;s++){l[s].id==v?t(l[s]).addClass("selected"):t(l[s]).removeClass("selected");for(var m=0;m<r.util.menu.length;m++)if(l[s].id==r.util.menu[m].menu_type){"classify_list_wrap"!==t(l[s]).parent().parent().parent().parent()[0].id&&"div"!==t(l[s]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(t(l[s]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),t(l[s]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),t(l[s]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}t("#classify_list_wrap #arrow_icon").bind("click",function(){t(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(t(this).parent().parent().parent().find("ul:first").removeClass("hide"),t(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),t(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(t(this).parent().parent().parent().find("ul:first").addClass("hide"),t(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),t(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))})}}t(".loading-mask").addClass("hide"),t(".main-wrap").removeClass("invisibility"),t("footer").removeClass("invisibility")},null,function(){t(".loading-mask").addClass("hide"),t(".main-wrap").removeClass("invisibility"),t("footer").removeClass("invisibility"),t("#list_loading").addClass("hide")}),u()}function u(e){e&&e.length>0&&(t("#label_list_wrap").html(t("#labelListTempl").tmpl(e)),t(".label-item").each(function(){for(var e=0;e<h.length;e++)t(this)[0].id==h[e]&&t(this).addClass("selected")}),t(".label-item").bind("click",function(e){var a=t(this)[0].id;if(t(this).hasClass("selected")){t(this).removeClass("selected");for(var i=0;i<h.length;i++)h[i]==a&&h.splice(i,1)}else t(this).addClass("selected"),h.push(a);console.log(h),s()}))}function c(e){var a=r.util.getCurrencySymbol(r.util.getLocalCurrency()),i=r.util.getAdvSource().u;i||(i=r.util.getQueryString("u"));var n=r.util.encodeMenuType(r.util.getUvid()),l="";i&&(l="?u="+i);for(var s=0;s<e.length;s++){for(var u=e[s],c=0;c<u.display_data.length;c++){var d=u.display_data[c];d.original_price=r.util.formatProductPrice(d.original_price,a),d.current_price=r.util.formatProductPrice(d.current_price,a),d.img_display=r.util.picUrl+d.img_display,d.color_img=r.util.picUrl+d.color_img,d.height=r.util.getImageHeight(),d.href=r.util.formatProductName(u.product_name)+"-d-"+r.util.encodeMenuType(u.product_id)+"-"+r.util.encodeMenuType(d.color_id)+"-"+n+".html"+l}u.showColor=sessionStorage.img_block}t("#item_list").html(t("#productItemTempl").tmpl(e)),t("#item_list #label1").text(t.i18n.map.Label1),t("#item_list #label2").text(t.i18n.map.Label2),o()}function d(){var e=0;e=g.amount%g.pageSize==0?g.amount/g.pageSize:g.amount/g.pageSize+1,t(function(){var a={bootstrapMajorVersion:1,currentPage:g.curPage,numberOfPages:5,totalPages:e,shouldShowPage:!0,onPageClicked:function(e,i,r,n){g.curPage!==n&&(g.curPage=n,t("html").scrollTop(0),s(),a.currentPage=n,"top_page"==e.currentTarget.id?t("#page").bootstrapPaginator(a):t("#top_page").bootstrapPaginator(a))}};t("#page").bootstrapPaginator(a),t("#top_page").bootstrapPaginator(a)})}function p(e){t("#item_list .color-wrap img").bind("click",function(a){a.stopPropagation();var i=t(this).parent().parent().parent().data().data,r=t(this).data().data,n=e[i].display_data[r];t(this).parent().parent().find("img").removeClass("selected"),t(this).addClass("selected");var o=n.href;t(this).parent().parent().parent().find("a:first").attr("href",o),t(this).parent().parent().parent().find("img:first").attr("src",n.img_display),t(this).parent().parent().parent().find(".product-name").html(n.pcName),t(this).parent().parent().parent().find(".product-ext-name").html(n.pcNameExt),t(this).parent().parent().parent().find(".price-wrap .goods-price").html(n.current_price),t(this).parent().parent().parent().find(".price-wrap .goods-del-price").html(n.original_price)})}console.log("list.js"),r.util.getCookie("isFirst")||(r.util.setCookie("isFirst",0),t(".loading-mask").removeClass("hide")),r.initLoginStatus(),r.setLanguageCallback(function(){t("#breadcrumb_home").text(t.i18n.map.Home),t("#sort_method").html(t.i18n.map.SortRecommended)});var m=1,g={amount:0,curPage:1,pageSize:0},h=[],f=window.location.href,_=r.util.getListParams(f),v=r.util.decodeMenuType(_[_.length-2]);r.util.menu=[],r.util.getClassifyNames(v,function(){l(),t("#sort_method").html(t.i18n.map.SortRecommended)}),t("#sort_method").html(t.i18n.map.SortRecommended),t("#sort_list li a").bind("click",function(){t("#sort_method").html(t(this)[0].text),g.curPage=1,m=Number(t(this)[0].id),s()}),r.setCurrencyCodeCallback(function(){s(v)}),function(){r.dao.getMenuAdsCnt({productType:v},function(e){e?(t(".category-adv-wrap").show(),t(".category-adv-wrap").html(e)):t(".category-adv-wrap").hide()})}()});