"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","bootstrapPaginator"],function(a,i,t,e,n,r){function o(){a("#menu_icon").click(function(){a("body").css("overflow","hidden"),a("#menu_mask").removeClass("hide")}),a("#menu_mask").click(function(){a("body").css("overflow","auto"),a("#menu_mask").addClass("hide")}),a("#prev_btn").unbind("click").click(function(){h.curPage>1&&(h.curPage=h.curPage-1,a("html").scrollTop(0),l()),a("#page").bootstrapPaginator("showPrevious"),a("#top_page").bootstrapPaginator("showPrevious")}),a("#next_btn").unbind("click").click(function(){var i=0;i=h.amount%h.pageSize==0?parseInt(h.amount/h.pageSize):parseInt(h.amount/h.pageSize)+1,h.curPage<i&&(h.curPage=h.curPage+1,a("html").scrollTop(0),l()),a("#page").bootstrapPaginator("showNext"),a("#top_page").bootstrapPaginator("showNext")})}function s(){if(n.util.menu&&n.util.menu.length>0){var i=n.util.getUvid(),t=n.util.getAdvSource().u;t||(t=n.util.getQueryString("u"));var e="";t&&(e="&u="+t);for(var r=n.util.menu.reverse(),o="<li><a id='breadcrumb_home' href='/'>"+a.i18n.map.Home+"</a></li>",s=0;s<r.length;s++){var l="list.html?id="+r[s].menu_type+"?uvid="+i+e;"1"==r[s].supportgp&&(l="group.html?type="+r[s].menu_type),s==r.length-1?(o=o+"<li class='active'><a href='"+l+"'>"+r[s].menu_name+"</a></li>",a("#product_classify_name").html(r[s].menu_name),document.title=r[s].menu_name):o=o+"<li><a href='"+l+"'>"+r[s].menu_name+"</a></li>"}a(".breadcrumb").html(o),a(".breadcrumb").removeClass("hide")}}function l(){a("#list_loading").removeClass("hide"),n.dao.productsbymenuandtag({currencyId:n.util.getLocalCurrency(),productType:_,currentPage:h.curPage,orderby:m,tags:g.join(",")},function(i){if(u(i.tags),i.page){h.amount=i.page.amount,h.pageSize=i.page.pageSize;var t=(h.curPage-1)*h.pageSize+1,e=h.curPage*h.pageSize;e>h.amount&&(e=h.amount),a("#current_product_number").html(t+"-"+e),a("#product_total_number").html(h.amount)}else a("#current_product_number").html("0-0"),a("#product_total_number").html(0);var r=i.products;if(r&&r.length>0?(d(r),p(r),c(),a("#item_list").show(),a(".empty-data").hide()):(a("#item_list").hide(),a(".empty-data").show()),a(".sort-wrap").removeClass("invisibility"),sessionStorage.menus&&!n.util.isMobile()){var o=JSON.parse(sessionStorage.menus);if(o){a("#classify_list_wrap").html(a("#classifyListTempl").tmpl(o)),a("#classify_list_wrap_parent").removeClass("hide");for(var s=a("#classify_list_wrap span"),l=0;l<s.length;l++){s[l].id==_?a(s[l]).addClass("selected"):a(s[l]).removeClass("selected");for(var m=0;m<n.util.menu.length;m++)if(s[l].id==n.util.menu[m].menu_type){"classify_list_wrap"!==a(s[l]).parent().parent().parent().parent()[0].id&&"div"!==a(s[l]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(a(s[l]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),a(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),a(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}a("#classify_list_wrap #arrow_icon").bind("click",function(){a(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(a(this).parent().parent().parent().find("ul:first").removeClass("hide"),a(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),a(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(a(this).parent().parent().parent().find("ul:first").addClass("hide"),a(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),a(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))}),a("#classify_list_wrap .media-body a").bind("click",function(){if("javascript:void(0)"==a(this).attr("href")){event.stopPropagation();var i=a(this).parent().parent().find(".media-right #arrow_icon");i.find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(i.parent().parent().parent().find("ul:first").removeClass("hide"),i.find("i").removeClass("icon-jiantou-xia-cuxiantiao"),i.find("i").addClass("icon-jiantou-shang-cuxiantiao")):(i.parent().parent().parent().find("ul:first").addClass("hide"),i.find("i").addClass("icon-jiantou-xia-cuxiantiao"),i.find("i").removeClass("icon-jiantou-shang-cuxiantiao"))}})}}else if(sessionStorage.menus&&n.util.isMobile()){a("#classify_list_wrap_parent").hide();var o=JSON.parse(sessionStorage.menus);if(o){a("#menu_list_wrap").html(a("#menuListTempl").tmpl(o));for(var s=a("#menu_list_wrap span"),l=0;l<s.length;l++){s[l].id==_?a(s[l]).addClass("selected"):a(s[l]).removeClass("selected");for(var m=0;m<n.util.menu.length;m++)if(s[l].id==n.util.menu[m].menu_type){"menu_list_wrap"!==a(s[l]).parent().parent().parent().parent()[0].id&&"div"!==a(s[l]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(a(s[l]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),a(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),a(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}a("#menu_list_wrap #arrow_icon").bind("click",function(){event.stopPropagation(),a(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(a(this).parent().parent().parent().find("ul:first").removeClass("hide"),a(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),a(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(a(this).parent().parent().parent().find("ul:first").addClass("hide"),a(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),a(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))}),a("#menu_list_wrap .media-body a").bind("click",function(){if("javascript:void(0)"==a(this).attr("href")){event.stopPropagation();var i=a(this).parent().parent().find(".media-right #arrow_icon");i.find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(i.parent().parent().parent().find("ul:first").removeClass("hide"),i.find("i").removeClass("icon-jiantou-xia-cuxiantiao"),i.find("i").addClass("icon-jiantou-shang-cuxiantiao")):(i.parent().parent().parent().find("ul:first").addClass("hide"),i.find("i").addClass("icon-jiantou-xia-cuxiantiao"),i.find("i").removeClass("icon-jiantou-shang-cuxiantiao"))}})}}a(".loading-mask").addClass("hide"),a("footer").removeClass("invisibility")},null,function(){a(".loading-mask").addClass("hide"),a("footer").removeClass("invisibility"),a("#list_loading").addClass("hide")}),u()}function u(i){i&&i.length>0&&(a("#label_list_wrap").html(a("#labelListTempl").tmpl(i)),a(".label-item").each(function(){for(var i=0;i<g.length;i++)a(this)[0].id==g[i]&&a(this).addClass("selected")}),a(".label-item").bind("click",function(i){var t=a(this)[0].id;if(a(this).hasClass("selected")){a(this).removeClass("selected");for(var e=0;e<g.length;e++)g[e]==t&&g.splice(e,1)}else a(this).addClass("selected"),g.push(t);console.log(g),l()}))}function d(i){var t=n.util.getCurrencySymbol(n.util.getLocalCurrency()),e=n.util.getUvid(),r=n.util.getAdvSource().u;r||(r=n.util.getQueryString("u"));var s="";r&&(s="&u="+r);for(var l=0;l<i.length;l++){for(var u=i[l],d=0;d<u.display_data.length;d++){var c=u.display_data[d];c.original_price=n.util.formatProductPrice(c.original_price,t),c.current_price=n.util.formatProductPrice(c.current_price,t),c.img_display=n.util.picUrl+c.img_display,c.color_img=n.util.picUrl+c.color_img,c.height=n.util.getImageHeight(),c.href="detail.html?id="+u.product_id+"&colorId="+c.color_id+"&uvid="+e+s}u.showColor=sessionStorage.img_block}a("#item_list").html(a("#productItemTempl").tmpl(i)),a("#item_list #label1").text(a.i18n.map.Label1),a("#item_list #label2").text(a.i18n.map.Label2),o()}function c(){var i=0;i=h.amount%h.pageSize==0?parseInt(h.amount/h.pageSize):parseInt(h.amount/h.pageSize)+1,n.util.isMobile()&&i>1?(a("#prev_btn").show(),a("#next_btn").show()):(a("#prev_btn").hide(),a("#next_btn").hide()),a(function(){var t={bootstrapMajorVersion:1,currentPage:h.curPage,numberOfPages:5,totalPages:i,shouldShowPage:!0,onPageClicked:function(i,e,n,r){h.curPage!==r&&(h.curPage=r,a("html").scrollTop(0),l(),t.currentPage=r,"top_page"==i.currentTarget.id?a("#page").bootstrapPaginator(t):a("#top_page").bootstrapPaginator(t))},onPageChanged:function(a,i,t){var e=window.location.href;e.indexOf("/#/")>-1&&(e=e.substring(0,e.indexOf("/#/"))),history.pushState("","",e+"/#/"+t)}};a("#page").bootstrapPaginator(t),a("#top_page").bootstrapPaginator(t)})}function p(i){a("#item_list .color-wrap img").bind("click",function(t){t.stopPropagation();var e=a(this).parent().parent().parent().data().data,n=a(this).data().data,r=i[e].display_data[n];a(this).parent().parent().find("img").removeClass("selected"),a(this).addClass("selected");var o=r.href;a(this).parent().parent().parent().find("a:first").attr("href",o),a(this).parent().parent().parent().find("img:first").attr("src",r.img_display),a(this).parent().parent().parent().find(".product-name").html(r.pcName),a(this).parent().parent().parent().find(".product-ext-name").html(r.pcNameExt),a(this).parent().parent().parent().find(".price-wrap .goods-price").html(r.current_price),a(this).parent().parent().parent().find(".price-wrap .goods-del-price").html(r.original_price)})}console.log("list.js"),n.util.getCookie("isFirst")||(n.util.setCookie("isFirst",0),a(".loading-mask").removeClass("hide")),n.initLoginStatus(),n.setLanguageCallback(function(){a("#breadcrumb_home").text(a.i18n.map.Home),a("#sort_method").html(a.i18n.map.SortRecommended)});var m=1,h={amount:0,curPage:1,pageSize:0},g=[],f=window.location.href,_=n.util.getQueryString("id");f.indexOf("/#/")>-1&&(h.curPage=parseInt(f.substring(f.indexOf("/#/")+3))),n.util.menu=[],n.util.getClassifyNames(_,function(){s(),a("#sort_method").html(a.i18n.map.SortRecommended)}),n.util.isMobile()?(a("#menu_icon").removeClass("hide"),a("#breadcrumb").css("height","50px"),a("#breadcrumb").css("padding","15px")):a("#menu_icon").addClass("hide"),a("#sort_method").html(a.i18n.map.SortRecommended),a("#sort_list li a").bind("click",function(){a("#sort_method").html(a(this)[0].text),h.curPage=1,m=Number(a(this)[0].id),l()}),n.setCurrencyCodeCallback(function(){l(_)}),function(){n.dao.getMenuAdsCnt({productType:_},function(i){i?(a(".category-adv-wrap").show(),a(".category-adv-wrap").html(i)):a(".category-adv-wrap").hide()})}()});