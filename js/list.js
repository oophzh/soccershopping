"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","bootstrapPaginator"],function(e,t,a,i,n,r){function o(){e("#menu_icon").click(function(){e("body").css("overflow","hidden"),e("#menu_mask").removeClass("hide")}),e("#menu_mask").click(function(){e("body").css("overflow","auto"),e("#menu_mask").addClass("hide")}),e("#prev_btn").unbind("click").click(function(){g.curPage>1&&(g.curPage=g.curPage-1,e("html").scrollTop(0),l()),e("#page").bootstrapPaginator("showPrevious"),e("#top_page").bootstrapPaginator("showPrevious")}),e("#next_btn").unbind("click").click(function(){var t=0;t=g.amount%g.pageSize==0?parseInt(g.amount/g.pageSize):parseInt(g.amount/g.pageSize)+1,g.curPage<t&&(g.curPage=g.curPage+1,e("html").scrollTop(0),l()),e("#page").bootstrapPaginator("showNext"),e("#top_page").bootstrapPaginator("showNext")})}function s(){if(n.util.menu&&n.util.menu.length>0){var t=n.util.getAdvSource().u;t||(t=n.util.getQueryString("u"));var a="";t&&(a="?u="+t);for(var i=n.util.menu.reverse(),r="<li><a id='breadcrumb_home' href='/'>"+e.i18n.map.Home+"</a></li>",o=0;o<i.length;o++){var s=i[o].menu_name+"-l-"+n.util.encodeMenuType(i[o].menu_type)+"-"+n.util.encodeMenuType(n.util.getUvid())+".html"+a;o==i.length-1?(r=r+"<li class='active'><a href='"+s+"'>"+i[o].menu_name+"</a></li>",e("#product_classify_name").html(i[o].menu_name),document.title=i[o].menu_name):r=r+"<li><a href='"+s+"'>"+i[o].menu_name+"</a></li>"}e(".breadcrumb").html(r),e(".breadcrumb").removeClass("hide")}}function l(){e("#list_loading").removeClass("hide"),n.dao.productsbymenuandtag({currencyId:n.util.getLocalCurrency(),productType:v,currentPage:g.curPage,orderby:m,tags:h.join(",")},function(t){if(u(t.tags),t.page){g.amount=t.page.amount,g.pageSize=t.page.pageSize;var a=(g.curPage-1)*g.pageSize+1,i=g.curPage*g.pageSize;i>g.amount&&(i=g.amount),e("#current_product_number").html(a+"-"+i),e("#product_total_number").html(g.amount)}else e("#current_product_number").html("0-0"),e("#product_total_number").html(0);var r=t.products;if(r&&r.length>0?(c(r),d(r),p(),e("#item_list").show(),e(".empty-data").hide()):(e("#item_list").hide(),e(".empty-data").show()),e(".sort-wrap").removeClass("invisibility"),sessionStorage.menus&&!n.util.isMobile()){var o=JSON.parse(sessionStorage.menus);if(o){e("#classify_list_wrap").html(e("#classifyListTempl").tmpl(o)),e("#classify_list_wrap_parent").removeClass("hide"),e("#classify_list_wrap a").each(function(){var t=n.util.getAdvSource().u,a=e(this).attr("href");if(a&&a.indexOf("-l-")>-1){var i=n.util.getListParams(a),r=i[i.length-2];r=n.util.encodeMenuType(r);var o=n.util.encodeMenuType(n.util.getUvid());t||(t=n.util.getQueryString("u"));var s="";t&&(s="?u="+t);var l=a.substring(0,a.indexOf("-l-")),u=n.util.formatProductName(l)+"-l-"+r+"-"+o+".html"+s;a=u,e(this).attr("href",u)}});for(var s=e("#classify_list_wrap span"),l=0;l<s.length;l++){s[l].id==v?e(s[l]).addClass("selected"):e(s[l]).removeClass("selected");for(var m=0;m<n.util.menu.length;m++)if(s[l].id==n.util.menu[m].menu_type){"classify_list_wrap"!==e(s[l]).parent().parent().parent().parent()[0].id&&"div"!==e(s[l]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(e(s[l]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),e(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),e(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}e("#classify_list_wrap #arrow_icon").bind("click",function(){e(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(e(this).parent().parent().parent().find("ul:first").removeClass("hide"),e(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),e(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(e(this).parent().parent().parent().find("ul:first").addClass("hide"),e(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),e(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))})}}else if(sessionStorage.menus&&n.util.isMobile()){e("#classify_list_wrap_parent").hide();var o=JSON.parse(sessionStorage.menus);if(o){e("#menu_list_wrap").html(e("#menuListTempl").tmpl(o)),e("#menu_list_wrap a").each(function(){event.stopPropagation();var t=n.util.getAdvSource().u,a=e(this).attr("href");if(a&&a.indexOf("-l-")>-1){var i=n.util.getListParams(a),r=i[i.length-2];r=n.util.encodeMenuType(r);var o=n.util.encodeMenuType(n.util.getUvid());t||(t=n.util.getQueryString("u"));var s="";t&&(s="?u="+t);var l=a.substring(0,a.indexOf("-l-")),u=n.util.formatProductName(l)+"-l-"+r+"-"+o+".html"+s;a=u,e(this).attr("href",u)}});for(var s=e("#menu_list_wrap span"),l=0;l<s.length;l++){s[l].id==v?e(s[l]).addClass("selected"):e(s[l]).removeClass("selected");for(var m=0;m<n.util.menu.length;m++)if(s[l].id==n.util.menu[m].menu_type){"menu_list_wrap"!==e(s[l]).parent().parent().parent().parent()[0].id&&"div"!==e(s[l]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(e(s[l]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),e(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),e(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}e("#menu_list_wrap #arrow_icon").bind("click",function(){event.stopPropagation(),e(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(e(this).parent().parent().parent().find("ul:first").removeClass("hide"),e(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),e(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(e(this).parent().parent().parent().find("ul:first").addClass("hide"),e(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),e(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))})}}e(".loading-mask").addClass("hide"),e(".main-wrap").removeClass("invisibility"),e("footer").removeClass("invisibility")},null,function(){e(".loading-mask").addClass("hide"),e(".main-wrap").removeClass("invisibility"),e("footer").removeClass("invisibility"),e("#list_loading").addClass("hide")}),u()}function u(t){t&&t.length>0&&(e("#label_list_wrap").html(e("#labelListTempl").tmpl(t)),e(".label-item").each(function(){for(var t=0;t<h.length;t++)e(this)[0].id==h[t]&&e(this).addClass("selected")}),e(".label-item").bind("click",function(t){var a=e(this)[0].id;if(e(this).hasClass("selected")){e(this).removeClass("selected");for(var i=0;i<h.length;i++)h[i]==a&&h.splice(i,1)}else e(this).addClass("selected"),h.push(a);console.log(h),l()}))}function c(t){var a=n.util.getCurrencySymbol(n.util.getLocalCurrency()),i=n.util.getAdvSource().u;i||(i=n.util.getQueryString("u"));var r=n.util.encodeMenuType(n.util.getUvid()),s="";i&&(s="?u="+i);for(var l=0;l<t.length;l++){for(var u=t[l],c=0;c<u.display_data.length;c++){var p=u.display_data[c];p.original_price=n.util.formatProductPrice(p.original_price,a),p.current_price=n.util.formatProductPrice(p.current_price,a),p.img_display=n.util.picUrl+p.img_display,p.color_img=n.util.picUrl+p.color_img,p.height=n.util.getImageHeight(),p.href=n.util.formatProductName(u.product_name)+"-d-"+n.util.encodeMenuType(u.product_id)+"-"+n.util.encodeMenuType(p.color_id)+"-"+r+".html"+s}u.showColor=sessionStorage.img_block}e("#item_list").html(e("#productItemTempl").tmpl(t)),e("#item_list #label1").text(e.i18n.map.Label1),e("#item_list #label2").text(e.i18n.map.Label2),o()}function p(){var t=0;t=g.amount%g.pageSize==0?parseInt(g.amount/g.pageSize):parseInt(g.amount/g.pageSize)+1,n.util.isMobile()&&t>1?(e("#prev_btn").show(),e("#next_btn").show()):(e("#prev_btn").hide(),e("#next_btn").hide()),e(function(){var a={bootstrapMajorVersion:1,currentPage:g.curPage,numberOfPages:5,totalPages:t,shouldShowPage:!0,onPageClicked:function(t,i,n,r){g.curPage!==r&&(g.curPage=r,e("html").scrollTop(0),l(),a.currentPage=r,"top_page"==t.currentTarget.id?e("#page").bootstrapPaginator(a):e("#top_page").bootstrapPaginator(a))},onPageChanged:function(e,t,a){var i=window.location.href;i.indexOf("/#/")>-1&&(i=i.substring(0,i.indexOf("/#/"))),history.pushState("","",i+"/#/"+a)}};e("#page").bootstrapPaginator(a),e("#top_page").bootstrapPaginator(a)})}function d(t){e("#item_list .color-wrap img").bind("click",function(a){a.stopPropagation();var i=e(this).parent().parent().parent().data().data,n=e(this).data().data,r=t[i].display_data[n];e(this).parent().parent().find("img").removeClass("selected"),e(this).addClass("selected");var o=r.href;e(this).parent().parent().parent().find("a:first").attr("href",o),e(this).parent().parent().parent().find("img:first").attr("src",r.img_display),e(this).parent().parent().parent().find(".product-name").html(r.pcName),e(this).parent().parent().parent().find(".product-ext-name").html(r.pcNameExt),e(this).parent().parent().parent().find(".price-wrap .goods-price").html(r.current_price),e(this).parent().parent().parent().find(".price-wrap .goods-del-price").html(r.original_price)})}console.log("list.js"),n.util.getCookie("isFirst")||(n.util.setCookie("isFirst",0),e(".loading-mask").removeClass("hide")),n.initLoginStatus(),n.setLanguageCallback(function(){e("#breadcrumb_home").text(e.i18n.map.Home),e("#sort_method").html(e.i18n.map.SortRecommended)});var m=1,g={amount:0,curPage:1,pageSize:0},h=[],f=window.location.href,_=n.util.getListParams(f),v=n.util.decodeMenuType(_[_.length-2]);f.indexOf("/#/")>-1&&(g.curPage=parseInt(f.substring(f.indexOf("/#/")+3))),n.util.menu=[],n.util.getClassifyNames(v,function(){s(),e("#sort_method").html(e.i18n.map.SortRecommended)}),n.util.isMobile()?(e("#menu_icon").removeClass("hide"),e("#breadcrumb").css("height","50px"),e("#breadcrumb").css("padding","15px")):e("#menu_icon").addClass("hide"),e("#sort_method").html(e.i18n.map.SortRecommended),e("#sort_list li a").bind("click",function(){e("#sort_method").html(e(this)[0].text),g.curPage=1,m=Number(e(this)[0].id),l()}),n.setCurrencyCodeCallback(function(){l(v)}),function(){n.dao.getMenuAdsCnt({productType:v},function(t){t?(e(".category-adv-wrap").show(),e(".category-adv-wrap").html(t)):e(".category-adv-wrap").hide()})}()});