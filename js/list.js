"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","bootstrapPaginator"],function(i,t,e,a,n,r){function o(){i("#menu_icon").click(function(){i("body").css("overflow","hidden"),i("#menu_mask").removeClass("hide")}),i("#menu_mask").click(function(){i("body").css("overflow","auto"),i("#menu_mask").addClass("hide")}),i("#prev_btn").unbind("click").click(function(){h.curPage>1&&(h.curPage=h.curPage-1,i("html").scrollTop(0),l()),i("#page").bootstrapPaginator("showPrevious"),i("#top_page").bootstrapPaginator("showPrevious")}),i("#next_btn").unbind("click").click(function(){var t=0;t=h.amount%h.pageSize==0?parseInt(h.amount/h.pageSize):parseInt(h.amount/h.pageSize)+1,h.curPage<t&&(h.curPage=h.curPage+1,i("html").scrollTop(0),l()),i("#page").bootstrapPaginator("showNext"),i("#top_page").bootstrapPaginator("showNext")})}function s(){if(n.util.menu&&n.util.menu.length>0){var t=n.util.getAdvSource().u;t||(t=n.util.getQueryString("u"));var e="";t&&(e="?u="+t);for(var a=n.util.menu.reverse(),r="<li><a id='breadcrumb_home' href='/'>"+i.i18n.map.Home+"</a></li>",o=0;o<a.length;o++){var s=a[o].menu_name+"-l-"+n.util.encodeMenuType(a[o].menu_type)+"-"+n.util.encodeMenuType(n.util.getUvid())+".html"+e;o==a.length-1?(r=r+"<li class='active'><a href='"+s+"'>"+a[o].menu_name+"</a></li>",i("#product_classify_name").html(a[o].menu_name),document.title=a[o].menu_name):r=r+"<li><a href='"+s+"'>"+a[o].menu_name+"</a></li>"}i(".breadcrumb").html(r),i(".breadcrumb").removeClass("hide")}}function l(){i("#list_loading").removeClass("hide"),n.dao.productsbymenuandtag({currencyId:n.util.getLocalCurrency(),productType:_,currentPage:h.curPage,orderby:m,tags:g.join(",")},function(t){if(u(t.tags),t.page){h.amount=t.page.amount,h.pageSize=t.page.pageSize;var e=(h.curPage-1)*h.pageSize+1,a=h.curPage*h.pageSize;a>h.amount&&(a=h.amount),i("#current_product_number").html(e+"-"+a),i("#product_total_number").html(h.amount)}else i("#current_product_number").html("0-0"),i("#product_total_number").html(0);var r=t.products;if(r&&r.length>0?(d(r),p(r),c(),i("#item_list").show(),i(".empty-data").hide()):(i("#item_list").hide(),i(".empty-data").show()),i(".sort-wrap").removeClass("invisibility"),sessionStorage.menus&&!n.util.isMobile()){var o=JSON.parse(sessionStorage.menus);if(o){i("#classify_list_wrap").html(i("#classifyListTempl").tmpl(o)),i("#classify_list_wrap_parent").removeClass("hide"),i("#classify_list_wrap a").each(function(){var t=i(this).attr("href");if(t&&t.indexOf("-l-")>-1){var e=n.util.getAdvSource().u;e||(e=n.util.getQueryString("u"));var a="";e&&(a="?u="+e);var r=n.util.encodeMenuType(n.util.getUvid()),o=n.util.getListParams(t),s=o[o.length-2];s=n.util.encodeMenuType(s);var l=t.substring(0,t.indexOf("-l-")),u=n.util.formatProductName(l)+"-l-"+s+"-"+r+".html"+a;i(this).attr("href",u)}else if(t&&t.indexOf("group.html")>-1){var r=n.util.encodeMenuType(n.util.getUvid()),d=t.substring(t.indexOf("menu_type=")+10),u="./../../../group.html?type="+n.util.encodeMenuType(d)+"&uvid="+r;i(this).attr("href",u)}});for(var s=i("#classify_list_wrap span"),l=0;l<s.length;l++){s[l].id==_?i(s[l]).addClass("selected"):i(s[l]).removeClass("selected");for(var m=0;m<n.util.menu.length;m++)if(s[l].id==n.util.menu[m].menu_type){"classify_list_wrap"!==i(s[l]).parent().parent().parent().parent()[0].id&&"div"!==i(s[l]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(i(s[l]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),i(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),i(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}i("#classify_list_wrap #arrow_icon").bind("click",function(){i(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(i(this).parent().parent().parent().find("ul:first").removeClass("hide"),i(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),i(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(i(this).parent().parent().parent().find("ul:first").addClass("hide"),i(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),i(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))}),i("#classify_list_wrap .media-body a").bind("click",function(){if("javascript:void(0)"==i(this).attr("href")){event.stopPropagation();var t=i(this).parent().parent().find(".media-right #arrow_icon");t.find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(t.parent().parent().parent().find("ul:first").removeClass("hide"),t.find("i").removeClass("icon-jiantou-xia-cuxiantiao"),t.find("i").addClass("icon-jiantou-shang-cuxiantiao")):(t.parent().parent().parent().find("ul:first").addClass("hide"),t.find("i").addClass("icon-jiantou-xia-cuxiantiao"),t.find("i").removeClass("icon-jiantou-shang-cuxiantiao"))}})}}else if(sessionStorage.menus&&n.util.isMobile()){i("#classify_list_wrap_parent").hide();var o=JSON.parse(sessionStorage.menus);if(o){i("#menu_list_wrap").html(i("#menuListTempl").tmpl(o)),i("#menu_list_wrap a").each(function(){event.stopPropagation();var t=i(this).attr("href");if(t&&t.indexOf("-l-")>-1){var e=n.util.getAdvSource().u;e||(e=n.util.getQueryString("u"));var a="";e&&(a="?u="+e);var r=n.util.encodeMenuType(n.util.getUvid()),o=n.util.getListParams(t),s=o[o.length-2];s=n.util.encodeMenuType(s);var l=t.substring(0,t.indexOf("-l-")),u=n.util.formatProductName(l)+"-l-"+s+"-"+r+".html"+a;i(this).attr("href",u)}else if(t&&t.indexOf("group.html")>-1){var r=n.util.encodeMenuType(n.util.getUvid()),d=t.substring(t.indexOf("menu_type=")+10),u="./../../../group.html?type="+n.util.encodeMenuType(d)+"&uvid="+r;i(this).attr("href",u)}});for(var s=i("#menu_list_wrap span"),l=0;l<s.length;l++){s[l].id==_?i(s[l]).addClass("selected"):i(s[l]).removeClass("selected");for(var m=0;m<n.util.menu.length;m++)if(s[l].id==n.util.menu[m].menu_type){"menu_list_wrap"!==i(s[l]).parent().parent().parent().parent()[0].id&&"div"!==i(s[l]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(i(s[l]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),i(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),i(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}i("#menu_list_wrap #arrow_icon").bind("click",function(){event.stopPropagation(),i(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(i(this).parent().parent().parent().find("ul:first").removeClass("hide"),i(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),i(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(i(this).parent().parent().parent().find("ul:first").addClass("hide"),i(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),i(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))}),i("#menu_list_wrap .media-body a").bind("click",function(){if("javascript:void(0)"==i(this).attr("href")){event.stopPropagation();var t=i(this).parent().parent().find(".media-right #arrow_icon");t.find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(t.parent().parent().parent().find("ul:first").removeClass("hide"),t.find("i").removeClass("icon-jiantou-xia-cuxiantiao"),t.find("i").addClass("icon-jiantou-shang-cuxiantiao")):(t.parent().parent().parent().find("ul:first").addClass("hide"),t.find("i").addClass("icon-jiantou-xia-cuxiantiao"),t.find("i").removeClass("icon-jiantou-shang-cuxiantiao"))}})}}i(".loading-mask").addClass("hide"),i("footer").removeClass("invisibility")},null,function(){i(".loading-mask").addClass("hide"),i("footer").removeClass("invisibility"),i("#list_loading").addClass("hide")}),u()}function u(t){t&&t.length>0&&(i("#label_list_wrap").html(i("#labelListTempl").tmpl(t)),i(".label-item").each(function(){for(var t=0;t<g.length;t++)i(this)[0].id==g[t]&&i(this).addClass("selected")}),i(".label-item").bind("click",function(t){var e=i(this)[0].id;if(i(this).hasClass("selected")){i(this).removeClass("selected");for(var a=0;a<g.length;a++)g[a]==e&&g.splice(a,1)}else i(this).addClass("selected"),g.push(e);console.log(g),l()}))}function d(t){var e=n.util.getCurrencySymbol(n.util.getLocalCurrency()),a=n.util.getAdvSource().u;a||(a=n.util.getQueryString("u"));var r=n.util.encodeMenuType(n.util.getUvid()),s="";a&&(s="?u="+a);for(var l=0;l<t.length;l++){for(var u=t[l],d=0;d<u.display_data.length;d++){var c=u.display_data[d];c.original_price=n.util.formatProductPrice(c.original_price,e),c.current_price=n.util.formatProductPrice(c.current_price,e),c.img_display=n.util.picUrl+c.img_display,c.color_img=n.util.picUrl+c.color_img,c.height=n.util.getImageHeight(),c.href=n.util.formatProductName(u.product_name)+"-d-"+n.util.encodeMenuType(u.product_id)+"-"+n.util.encodeMenuType(c.color_id)+"-"+r+".html"+s}u.showColor=sessionStorage.img_block}i("#item_list").html(i("#productItemTempl").tmpl(t)),i("#item_list #label1").text(i.i18n.map.Label1),i("#item_list #label2").text(i.i18n.map.Label2),o()}function c(){var t=0;t=h.amount%h.pageSize==0?parseInt(h.amount/h.pageSize):parseInt(h.amount/h.pageSize)+1,n.util.isMobile()&&t>1?(i("#prev_btn").show(),i("#next_btn").show()):(i("#prev_btn").hide(),i("#next_btn").hide()),i(function(){var e={bootstrapMajorVersion:1,currentPage:h.curPage,numberOfPages:5,totalPages:t,shouldShowPage:!0,onPageClicked:function(t,a,n,r){h.curPage!==r&&(h.curPage=r,i("html").scrollTop(0),l(),e.currentPage=r,"top_page"==t.currentTarget.id?i("#page").bootstrapPaginator(e):i("#top_page").bootstrapPaginator(e))},onPageChanged:function(i,t,e){var a=window.location.href;a.indexOf("/#/")>-1&&(a=a.substring(0,a.indexOf("/#/"))),history.pushState("","",a+"/#/"+e)}};i("#page").bootstrapPaginator(e),i("#top_page").bootstrapPaginator(e)})}function p(t){i("#item_list .color-wrap img").bind("click",function(e){e.stopPropagation();var a=i(this).parent().parent().parent().data().data,n=i(this).data().data,r=t[a].display_data[n];i(this).parent().parent().find("img").removeClass("selected"),i(this).addClass("selected");var o=r.href;i(this).parent().parent().parent().find("a:first").attr("href",o),i(this).parent().parent().parent().find("img:first").attr("src",r.img_display),i(this).parent().parent().parent().find(".product-name").html(r.pcName),i(this).parent().parent().parent().find(".product-ext-name").html(r.pcNameExt),i(this).parent().parent().parent().find(".price-wrap .goods-price").html(r.current_price),i(this).parent().parent().parent().find(".price-wrap .goods-del-price").html(r.original_price)})}console.log("list.js"),n.util.getCookie("isFirst")||(n.util.setCookie("isFirst",0),i(".loading-mask").removeClass("hide")),n.initLoginStatus(),n.setLanguageCallback(function(){i("#breadcrumb_home").text(i.i18n.map.Home),i("#sort_method").html(i.i18n.map.SortRecommended)});var m=1,h={amount:0,curPage:1,pageSize:0},g=[],f=window.location.href,v=n.util.getListParams(f),_=n.util.decodeMenuType(v[v.length-2]);f.indexOf("/#/")>-1&&(h.curPage=parseInt(f.substring(f.indexOf("/#/")+3))),n.util.menu=[],n.util.getClassifyNames(_,function(){s(),i("#sort_method").html(i.i18n.map.SortRecommended)}),n.util.isMobile()?(i("#menu_icon").removeClass("hide"),i("#breadcrumb").css("height","50px"),i("#breadcrumb").css("padding","15px")):i("#menu_icon").addClass("hide"),i("#sort_method").html(i.i18n.map.SortRecommended),i("#sort_list li a").bind("click",function(){i("#sort_method").html(i(this)[0].text),h.curPage=1,m=Number(i(this)[0].id),l()}),n.setCurrencyCodeCallback(function(){l(_)}),function(){n.dao.getMenuAdsCnt({productType:_},function(t){t?(i(".category-adv-wrap").show(),i(".category-adv-wrap").html(t)):i(".category-adv-wrap").hide()})}()});