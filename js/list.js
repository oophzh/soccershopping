"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","bootstrapPaginator"],function(t,e,a,i,n,r){function o(){t("#menu_icon").click(function(){t("body").css("overflow","hidden"),t("#menu_mask").removeClass("hide")}),t("#menu_mask").click(function(){t("body").css("overflow","auto"),t("#menu_mask").addClass("hide")}),t("#prev_btn").unbind("click").click(function(){g.curPage>1&&(g.curPage=g.curPage-1,t("html").scrollTop(0),l()),t("#page").bootstrapPaginator("showPrevious"),t("#top_page").bootstrapPaginator("showPrevious")}),t("#next_btn").unbind("click").click(function(){var e=0;e=g.amount%g.pageSize==0?parseInt(g.amount/g.pageSize):parseInt(g.amount/g.pageSize)+1,g.curPage<e&&(g.curPage=g.curPage+1,t("html").scrollTop(0),l()),t("#page").bootstrapPaginator("showNext"),t("#top_page").bootstrapPaginator("showNext")})}function s(){if(n.util.menu&&n.util.menu.length>0){var e=n.util.getAdvSource().u;e||(e=n.util.getQueryString("u"));var a="";e&&(a="?u="+e);for(var i=n.util.menu.reverse(),r="<li><a id='breadcrumb_home' href='/'>"+t.i18n.map.Home+"</a></li>",o=0;o<i.length;o++){var s=i[o].menu_name+"-l-"+n.util.encodeMenuType(i[o].menu_type)+"-"+n.util.encodeMenuType(n.util.getUvid())+".html"+a;o==i.length-1?(r=r+"<li class='active'><a href='"+s+"'>"+i[o].menu_name+"</a></li>",t("#product_classify_name").html(i[o].menu_name),document.title=i[o].menu_name):r=r+"<li><a href='"+s+"'>"+i[o].menu_name+"</a></li>"}t(".breadcrumb").html(r)}}function l(){t("#list_loading").removeClass("hide"),n.dao.productsbymenuandtag({currencyId:n.util.getLocalCurrency(),productType:v,currentPage:g.curPage,orderby:m,tags:h.join(",")},function(e){if(u(e.tags),e.page){g.amount=e.page.amount,g.pageSize=e.page.pageSize;var a=(g.curPage-1)*g.pageSize+1,i=g.curPage*g.pageSize;i>g.amount&&(i=g.amount),t("#current_product_number").html(a+"-"+i),t("#product_total_number").html(g.amount)}else t("#current_product_number").html("0-0"),t("#product_total_number").html(0);var r=e.products;if(r&&r.length>0?(c(r),d(r),1==g.curPage&&p(),t("#item_list").show(),t(".empty-data").hide()):(t("#item_list").hide(),t(".empty-data").show()),t(".sort-wrap").removeClass("invisibility"),sessionStorage.menus&&!n.util.isMobile()){var o=JSON.parse(sessionStorage.menus);if(o){t("#classify_list_wrap").html(t("#classifyListTempl").tmpl(o)),t("#classify_list_wrap a").each(function(){var e=n.util.getAdvSource().u,a=t(this).attr("href");if(a&&a.indexOf("-l-")>-1){var i=n.util.getListParams(a),r=i[i.length-2];r=n.util.encodeMenuType(r);var o=n.util.encodeMenuType(n.util.getUvid());e||(e=n.util.getQueryString("u"));var s="";e&&(s="?u="+e);var l=a.substring(0,a.indexOf("-l-")),u=n.util.formatProductName(l)+"-l-"+r+"-"+o+".html"+s;a=u,t(this).attr("href",u)}});for(var s=t("#classify_list_wrap span"),l=0;l<s.length;l++){s[l].id==v?t(s[l]).addClass("selected"):t(s[l]).removeClass("selected");for(var m=0;m<n.util.menu.length;m++)if(s[l].id==n.util.menu[m].menu_type){"classify_list_wrap"!==t(s[l]).parent().parent().parent().parent()[0].id&&"div"!==t(s[l]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(t(s[l]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),t(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),t(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}t("#classify_list_wrap #arrow_icon").bind("click",function(){t(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(t(this).parent().parent().parent().find("ul:first").removeClass("hide"),t(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),t(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(t(this).parent().parent().parent().find("ul:first").addClass("hide"),t(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),t(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))})}}else if(sessionStorage.menus&&n.util.isMobile()){t("#classify_list_wrap_parent").hide();var o=JSON.parse(sessionStorage.menus);if(o){t("#menu_list_wrap").html(t("#menuListTempl").tmpl(o)),t("#menu_list_wrap a").each(function(){event.stopPropagation();var e=n.util.getAdvSource().u,a=t(this).attr("href");if(a&&a.indexOf("-l-")>-1){var i=n.util.getListParams(a),r=i[i.length-2];r=n.util.encodeMenuType(r);var o=n.util.encodeMenuType(n.util.getUvid());e||(e=n.util.getQueryString("u"));var s="";e&&(s="?u="+e);var l=a.substring(0,a.indexOf("-l-")),u=n.util.formatProductName(l)+"-l-"+r+"-"+o+".html"+s;a=u,t(this).attr("href",u)}});for(var s=t("#menu_list_wrap span"),l=0;l<s.length;l++){s[l].id==v?t(s[l]).addClass("selected"):t(s[l]).removeClass("selected");for(var m=0;m<n.util.menu.length;m++)if(s[l].id==n.util.menu[m].menu_type){"menu_list_wrap"!==t(s[l]).parent().parent().parent().parent()[0].id&&"div"!==t(s[l]).parent().parent().parent().parent()[0].tagName.toLowerCase()&&(t(s[l]).parent().parent().parent().parent().find("ul:first").removeClass("hide"),t(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").addClass("icon-jiantou-shang-cuxiantiao"),t(s[l]).parent().parent().parent().parent().find(".icon-jiantou-xia-cuxiantiao:first").removeClass("icon-jiantou-xia-cuxiantiao"));break}}t("#menu_list_wrap #arrow_icon").bind("click",function(){event.stopPropagation(),t(this).find("i").hasClass("icon-jiantou-xia-cuxiantiao")?(t(this).parent().parent().parent().find("ul:first").removeClass("hide"),t(this).find("i").removeClass("icon-jiantou-xia-cuxiantiao"),t(this).find("i").addClass("icon-jiantou-shang-cuxiantiao")):(t(this).parent().parent().parent().find("ul:first").addClass("hide"),t(this).find("i").addClass("icon-jiantou-xia-cuxiantiao"),t(this).find("i").removeClass("icon-jiantou-shang-cuxiantiao"))})}}t(".loading-mask").addClass("hide"),t(".main-wrap").removeClass("invisibility"),t("footer").removeClass("invisibility")},null,function(){t(".loading-mask").addClass("hide"),t(".main-wrap").removeClass("invisibility"),t("footer").removeClass("invisibility"),t("#list_loading").addClass("hide")}),u()}function u(e){e&&e.length>0&&(t("#label_list_wrap").html(t("#labelListTempl").tmpl(e)),t(".label-item").each(function(){for(var e=0;e<h.length;e++)t(this)[0].id==h[e]&&t(this).addClass("selected")}),t(".label-item").bind("click",function(e){var a=t(this)[0].id;if(t(this).hasClass("selected")){t(this).removeClass("selected");for(var i=0;i<h.length;i++)h[i]==a&&h.splice(i,1)}else t(this).addClass("selected"),h.push(a);console.log(h),l()}))}function c(e){var a=n.util.getCurrencySymbol(n.util.getLocalCurrency()),i=n.util.getAdvSource().u;i||(i=n.util.getQueryString("u"));var r=n.util.encodeMenuType(n.util.getUvid()),s="";i&&(s="?u="+i);for(var l=0;l<e.length;l++){for(var u=e[l],c=0;c<u.display_data.length;c++){var p=u.display_data[c];p.original_price=n.util.formatProductPrice(p.original_price,a),p.current_price=n.util.formatProductPrice(p.current_price,a),p.img_display=n.util.picUrl+p.img_display,p.color_img=n.util.picUrl+p.color_img,p.height=n.util.getImageHeight(),p.href=n.util.formatProductName(u.product_name)+"-d-"+n.util.encodeMenuType(u.product_id)+"-"+n.util.encodeMenuType(p.color_id)+"-"+r+".html"+s}u.showColor=sessionStorage.img_block}t("#item_list").html(t("#productItemTempl").tmpl(e)),t("#item_list #label1").text(t.i18n.map.Label1),t("#item_list #label2").text(t.i18n.map.Label2),o()}function p(){var e=0;e=g.amount%g.pageSize==0?g.amount/g.pageSize:g.amount/g.pageSize+1,t(function(){var a={bootstrapMajorVersion:1,currentPage:g.curPage,numberOfPages:5,totalPages:e,shouldShowPage:!0,onPageClicked:function(e,i,n,r){g.curPage!==r&&(g.curPage=r,t("html").scrollTop(0),l(),a.currentPage=r,"top_page"==e.currentTarget.id?t("#page").bootstrapPaginator(a):t("#top_page").bootstrapPaginator(a))}};t("#page").bootstrapPaginator(a),t("#top_page").bootstrapPaginator(a)})}function d(e){t("#item_list .color-wrap img").bind("click",function(a){a.stopPropagation();var i=t(this).parent().parent().parent().data().data,n=t(this).data().data,r=e[i].display_data[n];t(this).parent().parent().find("img").removeClass("selected"),t(this).addClass("selected");var o=r.href;t(this).parent().parent().parent().find("a:first").attr("href",o),t(this).parent().parent().parent().find("img:first").attr("src",r.img_display),t(this).parent().parent().parent().find(".product-name").html(r.pcName),t(this).parent().parent().parent().find(".product-ext-name").html(r.pcNameExt),t(this).parent().parent().parent().find(".price-wrap .goods-price").html(r.current_price),t(this).parent().parent().parent().find(".price-wrap .goods-del-price").html(r.original_price)})}console.log("list.js"),n.util.getCookie("isFirst")||(n.util.setCookie("isFirst",0),t(".loading-mask").removeClass("hide")),n.initLoginStatus(),n.setLanguageCallback(function(){t("#breadcrumb_home").text(t.i18n.map.Home),t("#sort_method").html(t.i18n.map.SortRecommended)});var m=1,g={amount:0,curPage:1,pageSize:0},h=[],f=window.location.href,_=n.util.getListParams(f),v=n.util.decodeMenuType(_[_.length-2]);n.util.menu=[],n.util.getClassifyNames(v,function(){s(),t("#sort_method").html(t.i18n.map.SortRecommended)}),n.util.isMobile()?(t("#menu_icon").removeClass("hide"),t("#breadcrumb").css("height","50px"),t("#breadcrumb").css("padding","15px"),t("#prev_btn").show(),t("#next_btn").show()):(t("#menu_icon").addClass("hide"),t("#prev_btn").hide(),t("#next_btn").hide()),t("#sort_method").html(t.i18n.map.SortRecommended),t("#sort_list li a").bind("click",function(){t("#sort_method").html(t(this)[0].text),g.curPage=1,m=Number(t(this)[0].id),l()}),n.setCurrencyCodeCallback(function(){l(v)}),function(){n.dao.getMenuAdsCnt({productType:v},function(e){e?(t(".category-adv-wrap").show(),t(".category-adv-wrap").html(e)):t(".category-adv-wrap").hide()})}()});