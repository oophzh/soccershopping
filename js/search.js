"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","bootstrapPaginator"],function(t,r,e,a,i,o){function n(){}function u(r){i.dao.searchProducts({keyWord:r,currentPage:s.curPage,orderby:g,currencyId:i.util.getLocalCurrency()},function(r){if(r.page){s.amount=r.page.amount,s.pageSize=r.page.pageSize;var e=(s.curPage-1)*s.pageSize+1,a=s.curPage*s.pageSize;a>s.amount&&(a=s.amount),t("#current_product_number").html(e+"-"+a),t("#product_total_number").html(s.amount)}else t("#current_product_number").html("0-0"),t("#product_total_number").html(0);var i=r.products;i&&i.length>0?(c(i),p(i),1==s.curPage&&l(),t("#item_list").show(),t(".empty-data").hide()):(t("#item_list").hide(),t(".empty-data").show()),t(".sort-wrap").removeClass("invisibility")})}function c(r){var e=i.util.getCurrencySymbol(i.util.getLocalCurrency()),a=i.util.getAdvSource().u;a||(a=i.util.getQueryString("u"));var o=i.util.getUvid(),u="";a&&(u="&u="+a);for(var c=0;c<r.length;c++){for(var l=r[c],p=0;p<l.display_data.length;p++){var g=l.display_data[p];g.original_price=i.util.formatProductPrice(g.original_price,e),g.current_price=i.util.formatProductPrice(g.current_price,e),g.img_display=i.util.picUrl+g.img_display,g.color_img=i.util.picUrl+g.color_img,g.height=i.util.getImageHeight(),g.href="detail.html?id="+l.product_id+"&colorId="+g.color_id+"&uvid="+o+u}l.showColor=sessionStorage.img_block}t("#item_list").html(t("#productItemTempl").tmpl(r)),n()}function l(){var r=0;r=s.amount%s.pageSize==0?s.amount/s.pageSize:s.amount/s.pageSize+1,t(function(){var e={bootstrapMajorVersion:1,currentPage:s.curPage,numberOfPages:5,totalPages:r,shouldShowPage:!0,onPageClicked:function(r,a,i,o){s.curPage!==o&&(t("html").scrollTop(0),s.curPage=o,u(d),e.currentPage=o,"top_page"==r.currentTarget.id?t("#page").bootstrapPaginator(e):t("#top_page").bootstrapPaginator(e))}};t("#page").bootstrapPaginator(e),t("#top_page").bootstrapPaginator(e)})}function p(r){t("#item_list .color-wrap img").bind("click",function(e){e.stopPropagation();var a=t(this).parent().parent().parent().data().data,i=t(this).data().data,o=r[a].display_data[i];t(this).parent().parent().find("img").removeClass("selected"),t(this).addClass("selected");var n=o.href;t(this).parent().parent().parent().find("a:first").attr("href",n),t(this).parent().parent().parent().find("img:first").attr("src",o.img_display),t(this).parent().parent().parent().find(".price-wrap .goods-price").html(o.current_price),t(this).parent().parent().parent().find(".price-wrap .goods-del-price").html(o.original_price)})}console.log("list.js"),i.initLoginStatus();var g=1,s={amount:0,curPage:1,pageSize:0};setTimeout(function(){t("#sort_method").html(t("#sort_list li a:first")[0].text),t("#sort_list li a").bind("click",function(){t("#sort_method").html(t(this)[0].text),s.curPage=1,g=Number(t(this)[0].id),u(d)})},50);var d=i.util.getQueryString("keyword");t("#keywordSpan").html(d),t("#search_input").val(d),i.setCurrencyCodeCallback(function(){u(d)})});