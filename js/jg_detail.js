"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common","star","wall","front"],function(e,t,i,a,r,o,l,s){function c(){r.dao.productDetail({productId:g,currencyId:r.util.getLocalCurrency(),userId:r.util.getUserId()},function(t){if(t.product_id){for(var i=t,a=r.util.getCurrencySymbol(r.util.getLocalCurrency()),o=0;o<i.color_data.length;o++){var l=i.color_data[o];l.original_price=r.util.formatProductPrice(l.original_price,a),l.current_price=r.util.formatProductPrice(l.current_price,a),l.img_display=r.util.picUrl+l.img_display,l.color_img=r.util.picUrl+l.color_img;for(var s=0;s<l.img_groups.length;s++){var c=l.img_groups[s];c.small_img=r.util.picUrl+c.small_img,c.big_img="/pic/"+c.big_img}}e("#product_main_image").attr("src",i.color_data[0].img_groups[0].big_img),e("#product_image_list").html("");var m=i.color_data[0].img_groups.slice(1,i.color_data[0].img_groups.length);e("#imageTempl").tmpl(m).appendTo("#product_image_list"),e("#product_name").html(i.color_data[0].pcName),e("#product_ext_name").html(i.color_data[0].pcNameExt),e("#current_price").html(i.color_data[0].current_price),i.product_des&&(e("#desc_wrap").removeClass("hide"),e(".description").html(i.product_des)),i.color_data[0].videos&&i.color_data[0].videos.length>0?null!==(u=i.color_data[0].videos[0].path)&&n():u=null}})}function m(){r.dao.getCommentsByPrd({currentPage:_.curPage,productId:g,userId:r.util.getUserId()},function(t){if(!t)return void e("#comment_list_wrap").addClass("hide");if(t.page&&(_.amount=t.page.amount,_.pageSize=t.page.pageSize),t&&t.comments.length>0){for(var i=t.comments,a=0;a<i.length;a++){var o=i[a];o.crtime=r.util.formatOrderDateTime(o.crtime),o.usrico&&(o.usrImage=r.util.userIconUrl+o.usrico,o.usrErrorImage='javascript:this.src="resources/img/user/'+o.usrico+'";');for(var l=0;l<o.zps.length;l++){var s=o.zps[l];s.crtime=r.util.formatOrderDateTime(s.crtime);for(var c=0;c<s.shareimgs.length;c++)s.shareimgs[c]=r.util.commentPicUrl+s.shareimgs[c]}for(var l=0;l<o.shareimgs.length;l++)o.shareimgs[l]=r.util.commentPicUrl+o.shareimgs[l]}e("#comment_list").html(e("#commentItemTempl").tmpl(i)),e("#comment_list #color_title").html(e.i18n.map.ColorTitle),e("#comment_list .reply-text").html(e.i18n.map.DetailCommentReply),e("#comment_list img.lazy").lazyload({effect:"fadeIn"}),e(".empty-data").addClass("hide"),e("#comment_list .comment-item-wrap input").each(function(){e(this).rating({step:1,size:"xs",showClear:!1,min:0,max:5,disabled:!0,showCaption:!1}).rating("showStars",e(this).data().data)}),e("#comment_list .image-wrap img").each(function(){e(this).click(function(){e(this).parent().find("img").removeClass("selected"),e(this).addClass("selected"),d(e(this).parent())})}),e("#comment_list .top-wrap").each(function(){e(this).click(function(){var t=e(this).data().data;if(t){e("#iframe_loading").removeClass("hide"),e("#video").addClass("hide"),e("#video").attr("src",t);document.getElementById("video").onload=function(){e("#iframe_loading").addClass("hide"),e("#video").removeClass("hide")}}e("#video_mask").removeClass("hide"),e("#video_mask #close_video_btn").click(function(){e("#video").attr("src",""),e("#video_mask").addClass("hide")})})}),e("#comment_list_wrap").removeClass("hide")}else e("#comment_list_wrap").addClass("hide")})}function d(e){commentViewer=e.viewer({url:"data-original",toolbar:{zoomIn:!1,zoomOut:!1,oneToOne:!1,reset:!1,prev:{show:!0,size:"large"},play:!1,next:{show:!0,size:"large"},rotateLeft:!1,rotateRight:!1,flipHorizontal:!1,flipVertical:!1},navbar:!1,movable:!0,title:!1,transition:!1,button:!1,hide:function(){e.find("img").removeClass("selected")}})}function n(){e("#play_btn").removeClass("hide"),e("#play_btn").click(function(){if(u){e("#iframe_loading").removeClass("hide"),e("#video").addClass("hide"),e("#video").attr("src",u);document.getElementById("video").onload=function(){e("#iframe_loading").addClass("hide"),e("#video").removeClass("hide")}}e("#video_mask").removeClass("hide"),e("#video_mask #close_video_btn").click(function(){e("#video").attr("src",""),e("#video_mask").addClass("hide")})})}console.log("jg_detail.js");var u,g=r.util.getQueryString("i"),_=(r.util.getQueryString("c"),{amount:0,curPage:1,pageSize:0});r.setCurrencyCodeCallback(function(){c(),m()}),e(document).ready(function(){e("footer").addClass("hide")})});